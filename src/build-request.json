{
  "kind": "build_request",
  "title": "Add video text overlay engine with customizable captions and export",
  "projectName": "NicheHub",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-41",
      "text": "Integrate a video processing library (ffmpeg.wasm or HTML5 Canvas overlay system) into the frontend to enable burning generated script text directly onto video files as a permanent layer",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "Video Canvas Engine: Integrate a video processing library (like ffmpeg.wasm or an HTML5 Canvas overlay) so the app can 'burn' the generated script directly onto the video as a layer."
        ]
      },
      "acceptanceCriteria": [
        "ffmpeg.wasm or equivalent video processing library is installed and initialized in the frontend",
        "The system can load a video file and render text overlays onto it",
        "Text can be permanently burned into the video output file"
      ]
    },
    {
      "id": "REQ-42",
      "text": "Add text overlay customization controls in the ScriptLab component that allow users to select Font, Color, and Position (Top, Center, Bottom) after an itinerary script is generated",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "Text Overlay Settings: Add a feature where, after a script is generated, I can choose the Font, Color, and Position (Top, Center, Bottom) of the text on the video."
        ]
      },
      "acceptanceCriteria": [
        "A settings panel appears in ScriptLab after script generation with Font, Color, and Position controls",
        "Users can select from multiple font options",
        "Users can choose text color via color picker or preset colors",
        "Users can choose text position: Top, Center, or Bottom",
        "Selected settings are preserved when generating the final video output"
      ]
    },
    {
      "id": "REQ-43",
      "text": "Add an 'Export with Captions' button in the ScriptLab component that renders a new video version with the AI-generated script text permanently overlaid using the selected font, color, and position settings, and provides a download link for the processed video file",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "High-Quality Export: Add an 'Export with Captions' button. When I click it, the app should render a new version of my video with the AI script permanently attached so I can download it to my phone and post it directly to social media."
        ]
      },
      "acceptanceCriteria": [
        "An 'Export with Captions' button is visible in ScriptLab after script generation and overlay settings are configured",
        "Clicking the button triggers video processing that burns the script text onto the video",
        "The processed video maintains high quality and original resolution",
        "A download link or automatic download is provided for the captioned video file",
        "The exported video file is in a format compatible with mobile devices and social media platforms (MP4)",
        "Processing progress is displayed with a loading indicator",
        "Success and error states are communicated via toast notifications"
      ]
    },
    {
      "id": "REQ-44",
      "text": "Add text overlay customization controls in the RepurposeModal component that allow users to select Font, Color, and Position (Top, Center, Bottom) after AI captions are generated for Facebook, Instagram, and TikTok",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "Text Overlay Settings: Add a feature where, after a script is generated, I can choose the Font, Color, and Position (Top, Center, Bottom) of the text on the video."
        ]
      },
      "acceptanceCriteria": [
        "A settings panel appears in RepurposeModal after caption generation with Font, Color, and Position controls",
        "Users can select from multiple font options",
        "Users can choose text color via color picker or preset colors",
        "Users can choose text position: Top, Center, or Bottom",
        "Selected settings are preserved for the export operation"
      ]
    },
    {
      "id": "REQ-45",
      "text": "Add an 'Export with Captions' button in the RepurposeModal component that renders a new video version with the platform-specific AI-generated caption text permanently overlaid using the selected font, color, and position settings, and provides a download link for the processed video file",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "High-Quality Export: Add an 'Export with Captions' button. When I click it, the app should render a new version of my video with the AI script permanently attached so I can download it to my phone and post it directly to social media."
        ]
      },
      "acceptanceCriteria": [
        "An 'Export with Captions' button is visible in RepurposeModal after captions are generated and overlay settings are configured",
        "Clicking the button triggers video processing that burns the selected platform caption text onto the video",
        "Users can choose which platform's caption to burn onto the video (Facebook, Instagram, or TikTok)",
        "The processed video maintains high quality and original resolution",
        "A download link or automatic download is provided for the captioned video file",
        "The exported video file is in MP4 format compatible with mobile devices and social media platforms",
        "Processing progress is displayed with a loading indicator",
        "Success and error states are communicated via toast notifications"
      ]
    }
  ],
  "constraints": [
    "Do not change the backend schema or main actor structure",
    "Preserve all existing Internet Identity authentication flows",
    "Maintain the existing workspace context and switching functionality",
    "Keep all existing AI caption and itinerary generation logic intact",
    "Do not modify files in frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, or frontend/src/components/ui"
  ],
  "nonGoals": [
    "Real-time video streaming or live editing features",
    "Server-side video processing or backend video rendering",
    "Multi-track video editing capabilities",
    "Animation or transitions between text overlays",
    "Batch processing multiple videos at once",
    "Cloud storage integration for exported videos"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}